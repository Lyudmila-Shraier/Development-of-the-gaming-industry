# Развитие игровой индустрии

- Автор: Шрайер Людмила
- Дата: 01.11.2025

### Цели и задачи проекта

Цель: помочь коллегам из «Секретов Темнолесья» изучить развитие игровой индустрии.

Задачи: 
* Познакомиться с данными, проверить их корректность и провести предобработку, получив необходимый срез данных;
* Отобрать данные по времени выхода игры;
* Категоризовать игры по оценкам пользователей и экспертов;
* Выделить топ-7 платформ по количеству игр, выпущенных за весь требуемый период

### Описание данных

* Name — название игры.
* Platform — название платформы.
* Year of Release — год выпуска игры.
* Genre — жанр игры.
* NA sales — продажи в Северной Америке (в миллионах проданных копий).
* EU sales — продажи в Европе (в миллионах проданных копий).
* JP sales — продажи в Японии (в миллионах проданных копий).
* Other sales — продажи в других странах (в миллионах проданных копий).
* Critic Score — оценка критиков (от 0 до 100).
* User Score — оценка пользователей (от 0 до 10).
* Rating — рейтинг организации ESRB (англ. Entertainment Software Rating Board). Эта ассоциация определяет рейтинг компьютерных игр и присваивает им подходящую возрастную категорию.

### Содержимое проекта

1. Загрузка данных и знакомство с ними
2. Проверка ошибок в данных и их предобработка
2.1. Названия, или метки, столбцов датафрейма
2.2. Типы данных
2.3. Наличие пропусков в данных
2.4. Явные и неявные дубликаты в данных
3. Фильтрация данных
4. Категоризация данных
5. Итоговый вывод


---

## Загрузка данных и знакомство с ними





```python
import pandas as pd
```


```python
df = pd.read_csv('/datasets/new_games.csv')
display(df.head())
import warnings
warnings.filterwarnings("ignore")

```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Platform</th>
      <th>Year of Release</th>
      <th>Genre</th>
      <th>NA sales</th>
      <th>EU sales</th>
      <th>JP sales</th>
      <th>Other sales</th>
      <th>Critic Score</th>
      <th>User Score</th>
      <th>Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wii Sports</td>
      <td>Wii</td>
      <td>2006.0</td>
      <td>Sports</td>
      <td>41.36</td>
      <td>28.96</td>
      <td>3.77</td>
      <td>8.45</td>
      <td>76.0</td>
      <td>8</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Super Mario Bros.</td>
      <td>NES</td>
      <td>1985.0</td>
      <td>Platform</td>
      <td>29.08</td>
      <td>3.58</td>
      <td>6.81</td>
      <td>0.77</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mario Kart Wii</td>
      <td>Wii</td>
      <td>2008.0</td>
      <td>Racing</td>
      <td>15.68</td>
      <td>12.76</td>
      <td>3.79</td>
      <td>3.29</td>
      <td>82.0</td>
      <td>8.3</td>
      <td>E</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Wii Sports Resort</td>
      <td>Wii</td>
      <td>2009.0</td>
      <td>Sports</td>
      <td>15.61</td>
      <td>10.93</td>
      <td>3.28</td>
      <td>2.95</td>
      <td>80.0</td>
      <td>8</td>
      <td>E</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pokemon Red/Pokemon Blue</td>
      <td>GB</td>
      <td>1996.0</td>
      <td>Role-Playing</td>
      <td>11.27</td>
      <td>8.89</td>
      <td>10.22</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>


* информация о данных


```python
print(df.info())
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 16956 entries, 0 to 16955
    Data columns (total 11 columns):
     #   Column           Non-Null Count  Dtype  
    ---  ------           --------------  -----  
     0   Name             16954 non-null  object 
     1   Platform         16956 non-null  object 
     2   Year of Release  16681 non-null  float64
     3   Genre            16954 non-null  object 
     4   NA sales         16956 non-null  float64
     5   EU sales         16956 non-null  object 
     6   JP sales         16956 non-null  object 
     7   Other sales      16956 non-null  float64
     8   Critic Score     8242 non-null   float64
     9   User Score       10152 non-null  object 
     10  Rating           10085 non-null  object 
    dtypes: float64(4), object(7)
    memory usage: 1.4+ MB
    None


 

Промежуточный вывод: представленные данные соответствуют описанию. В столбцах "Year of Release", "EU sales", "JP sales", "User Score" тип данных определён неверно. Также большое количество пропусков представенно в столбцах с оценкой игр. 
Некорректный формат названий столбцов тоже нужно исправить.

---

##  Проверка ошибок в данных и их предобработка


### Названия или метки, столбцов датафрейма


```python
print(df.columns)
```

    Index(['Name', 'Platform', 'Year of Release', 'Genre', 'NA sales', 'EU sales',
           'JP sales', 'Other sales', 'Critic Score', 'User Score', 'Rating'],
          dtype='object')



```python
df.columns = df.columns.str.lower()
df.columns = df.columns.str.replace(' ', '_')
display(df.columns)

```


    Index(['name', 'platform', 'year_of_release', 'genre', 'na_sales', 'eu_sales',
           'jp_sales', 'other_sales', 'critic_score', 'user_score', 'rating'],
          dtype='object')


###  Типы данных


```python
# ищем ошибку в столбцах, которые имают неверный тип данных
print(df['eu_sales'].unique())
print(df['jp_sales'].unique())
print(df['user_score'].unique())
```

    ['28.96' '3.58' '12.76' '10.93' '8.89' '2.26' '9.14' '9.18' '6.94' '0.63'
     '10.95' '7.47' '6.18' '8.03' '4.89' '8.49' '9.09' '0.4' '3.75' '9.2'
     '4.46' '2.71' '3.44' '5.14' '5.49' '3.9' '5.35' '3.17' '5.09' '4.24'
     '5.04' '5.86' '3.68' '4.19' '5.73' '3.59' '4.51' '2.55' '4.02' '4.37'
     '6.31' '3.45' '2.81' '2.85' '3.49' '0.01' '3.35' '2.04' '3.07' '3.87'
     '3.0' '4.82' '3.64' '2.15' '3.69' '2.65' '2.56' '3.11' '3.14' '1.94'
     '1.95' '2.47' '2.28' '3.42' '3.63' '2.36' '1.71' '1.85' '2.79' '1.24'
     '6.12' '1.53' '3.47' '2.24' '5.01' '2.01' '1.72' '2.07' '6.42' '3.86'
     '0.45' '3.48' '1.89' '5.75' '2.17' '1.37' '2.35' '1.18' '2.11' '1.88'
     '2.83' '2.99' '2.89' '3.27' '2.22' '2.14' '1.45' '1.75' '1.04' '1.77'
     '3.02' '2.75' '2.16' '1.9' '2.59' '2.2' '4.3' '0.93' '2.53' '2.52' '1.79'
     '1.3' '2.6' '1.58' '1.2' '1.56' '1.34' '1.26' '0.83' '6.21' '2.8' '1.59'
     '1.73' '4.33' '1.83' '0.0' '2.18' '1.98' '1.47' '0.67' '1.55' '1.91'
     '0.69' '0.6' '1.93' '1.64' '0.55' '2.19' '1.11' '2.29' '2.5' '0.96'
     '1.21' '1.12' '0.77' '1.69' '1.08' '0.79' '2.37' '2.46' '0.26' '0.75'
     '1.25' '2.43' '0.98' '0.74' '2.23' '0.61' '2.45' '1.41' '1.8' '3.28'
     '1.16' '1.99' '1.38' '1.36' '1.17' '1.19' '0.99' '1.68' '2.0' '1.33'
     '1.57' '1.48' '2.1' '1.27' '1.97' '0.91' '1.39' '1.96' '0.24' '1.51'
     '0.14' '1.29' '2.39' '1.03' '0.5' '0.58' '1.31' '2.02' '1.32' '1.01'
     '2.27' '2.3' '1.82' '2.78' '0.44' '0.48' '0.27' '0.21' '2.48' '0.51'
     '1.52' '0.04' '0.28' '1.35' '0.87' '2.13' '1.13' '1.76' '0.76' '2.12'
     '0.66' '1.6' '1.44' '1.43' '1.7' '0.47' '1.87' '0.86' '0.73' '1.28'
     '0.81' '1.09' '0.68' '1.22' '1.4' '1.02' '1.49' '1.14' '0.49' '0.9'
     '0.38' '1.42' '0.95' '1.62' '0.71' '1.05' '0.92' '0.33' '0.3' '1.67'
     '1.0' '0.89' '0.1' '0.72' '0.59' '0.56' '0.16' '0.97' '0.62' 'unknown'
     '0.85' '0.94' '0.88' '0.84' '1.06' '0.2' '1.15' '0.8' '1.1' '0.7' '1.92'
     '0.32' '0.15' '0.53' '0.09' '1.46' '0.29' '0.22' '1.23' '0.07' '0.17'
     '0.54' '0.36' '0.31' '1.84' '0.52' '0.11' '0.64' '0.12' '2.05' '1.63'
     '0.82' '0.08' '0.57' '1.65' '0.19' '0.02' '0.43' '0.25' '1.5' '0.18'
     '0.39' '0.13' '1.07' '0.46' '0.41' '0.06' '0.03' '0.37' '0.05' '0.23'
     '0.65' '0.42' '0.34' '0.35' '0.78']
    ['3.77' '6.81' '3.79' '3.28' '10.22' '4.22' '6.5' '2.93' '4.7' '0.28'
     '1.93' '4.13' '7.2' '3.6' '0.24' '2.53' '0.98' '0.41' '3.54' '4.16'
     '6.04' '4.18' '3.84' '0.06' '0.47' '5.38' '5.32' '5.65' '1.87' '0.13'
     '3.12' '0.36' '0.11' '4.35' '0.65' '0.07' '0.08' '0.49' '0.3' '2.66'
     '2.69' '0.48' '0.38' '5.33' '1.91' '3.96' '3.1' '1.1' '1.2' '0.14' '2.54'
     '2.14' '0.81' '2.12' '0.44' '3.15' '1.25' '0.04' '0.0' '2.47' '2.23'
     '1.69' '0.01' '3.0' '0.02' '4.39' '1.98' '0.1' '3.81' '0.05' '2.49'
     '1.58' '3.14' '2.73' '0.66' '0.22' '3.63' '1.45' '1.31' '2.43' '0.7'
     '0.35' '1.4' '0.6' '2.26' '1.42' '1.28' '1.39' '0.87' '0.17' '0.94'
     '0.19' '0.21' '1.6' '0.16' '1.03' '0.25' '2.06' '1.49' '1.29' '0.09'
     '2.87' '0.03' '0.78' '0.83' '2.33' '2.02' '1.36' '1.81' '1.97' '0.91'
     '0.99' '0.95' '2.0' '1.01' '2.78' '2.11' '1.09' '0.2' '1.9' '1.27' '3.61'
     '1.57' '2.2' '1.7' '1.08' '0.15' '1.11' '0.29' '1.54' '0.12' '0.89'
     '4.87' '1.52' '1.32' '1.15' '4.1' '1.46' '0.46' '1.05' '1.61' '0.26'
     '1.38' '0.62' '0.73' '0.57' '0.31' '0.58' '1.76' '2.1' '0.9' '0.51'
     '0.64' '2.46' '0.23' '0.37' '0.92' '1.07' '2.62' '1.12' '0.54' '0.27'
     '0.59' '3.67' '0.55' '1.75' '3.44' '0.33' '2.55' '2.32' '2.79' '0.74'
     '3.18' '0.82' '0.77' '0.4' '2.35' '3.19' '0.8' '0.76' '3.03' '0.88'
     'unknown' '0.45' '1.16' '0.34' '1.19' '1.13' '2.13' '1.96' '0.71' '1.04'
     '2.68' '0.68' '2.65' '0.96' '2.41' '0.52' '0.18' '1.34' '1.48' '2.34'
     '1.06' '1.21' '2.29' '1.63' '2.05' '2.17' '1.56' '1.35' '1.33' '0.63'
     '0.79' '0.75' '0.53' '1.53' '1.3' '0.39' '0.69' '0.42' '0.93' '0.56'
     '0.84' '0.72' '0.32' '1.71' '1.65' '0.61' '1.51' '1.5' '1.44' '1.24'
     '1.18' '1.37' '1.0' '1.26' '0.85' '0.43' '0.67' '1.14' '0.86' '1.17'
     '0.5' '1.02' '0.97']
    ['8' nan '8.3' '8.5' '6.6' '8.4' '8.6' '7.7' '6.3' '7.4' '8.2' '9' '7.9'
     '8.1' '8.7' '7.1' '3.4' '5.3' '4.8' '3.2' '8.9' '6.4' '7.8' '7.5' '2.6'
     '7.2' '9.2' '7' '7.3' '4.3' '7.6' '5.7' '5' '9.1' '6.5' 'tbd' '8.8' '6.9'
     '9.4' '6.8' '6.1' '6.7' '5.4' '4' '4.9' '4.5' '9.3' '6.2' '4.2' '6' '3.7'
     '4.1' '5.8' '5.6' '5.5' '4.4' '4.6' '5.9' '3.9' '3.1' '2.9' '5.2' '3.3'
     '4.7' '5.1' '3.5' '2.5' '1.9' '3' '2.7' '2.2' '2' '9.5' '2.1' '3.6' '2.8'
     '1.8' '3.8' '0' '1.6' '9.6' '2.4' '1.7' '1.1' '0.3' '1.5' '0.7' '1.2'
     '2.3' '0.5' '1.3' '0.2' '0.6' '1.4' '0.9' '1' '9.7']


Сделав небольшой анализ, мы замечаем, что числа представлены в виде строковых значений, также в столбцах присутствуют такие слова, как 'unknown' и 'tbd'.
Для дальнейшей работы необходимо присвоить им верный тип данных и заменить слова 'unknown' и 'tbd' на nan.


```python
df['eu_sales'] = pd.to_numeric(df['eu_sales'], errors = 'coerce').astype('float64')
df['jp_sales'] = pd.to_numeric(df['jp_sales'], errors = 'coerce').astype('float64')
df['user_score'] = pd.to_numeric(df['user_score'], errors = 'coerce').astype('float64')

print(df.info())
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 16956 entries, 0 to 16955
    Data columns (total 11 columns):
     #   Column           Non-Null Count  Dtype  
    ---  ------           --------------  -----  
     0   name             16954 non-null  object 
     1   platform         16956 non-null  object 
     2   year_of_release  16681 non-null  float64
     3   genre            16954 non-null  object 
     4   na_sales         16956 non-null  float64
     5   eu_sales         16950 non-null  float64
     6   jp_sales         16952 non-null  float64
     7   other_sales      16956 non-null  float64
     8   critic_score     8242 non-null   float64
     9   user_score       7688 non-null   float64
     10  rating           10085 non-null  object 
    dtypes: float64(7), object(4)
    memory usage: 1.4+ MB
    None


### 2.3. Наличие пропусков в данных


```python
print(f'Количество пропусков в абсолютном значении: \n{df.isna().sum()}')
      
print(f'Количество пропусков в относительном значении: \n{df.isna().mean() * 100}')
prom_itog = df # + сохраним переменную до предобработки
print(len(prom_itog))
```

    Количество пропусков в абсолютном значении: 
    name                  2
    platform              0
    year_of_release     275
    genre                 2
    na_sales              0
    eu_sales              6
    jp_sales              4
    other_sales           0
    critic_score       8714
    user_score         9268
    rating             6871
    dtype: int64
    Количество пропусков в относительном значении: 
    name                0.011795
    platform            0.000000
    year_of_release     1.621845
    genre               0.011795
    na_sales            0.000000
    eu_sales            0.035386
    jp_sales            0.023590
    other_sales         0.000000
    critic_score       51.391838
    user_score         54.659118
    rating             40.522529
    dtype: float64
    16956


Промежуточный вывод: проверив данные на наличие пропусков, мы сразу видим, что поти половина значений отсутствует в столбцах "critic_score" (51.4 %) с оценкой критиков и 
"user_score" (54.7 %) с оценкой пользователей. Это может говорить о непопулярности игр. Для некоторых даже не был назначен рейтинг организации ESRB (количество пропусков 40.5 %). Также присутствует 275 пропусков в столбце с годом выпуска игры

Столбцы critic_score, user_score и rating имеют большое количество пропусков, поэтому удалять строки с их отсутствием будет неправильно. Лучше заменить их нейтральным (отрицательным) числом.


```python
# удалим игры с отсутствием названия и года 
df = df.dropna(subset = ['year_of_release', 'name'])
print(df.info())
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 16679 entries, 0 to 16955
    Data columns (total 11 columns):
     #   Column           Non-Null Count  Dtype  
    ---  ------           --------------  -----  
     0   name             16679 non-null  object 
     1   platform         16679 non-null  object 
     2   year_of_release  16679 non-null  float64
     3   genre            16679 non-null  object 
     4   na_sales         16679 non-null  float64
     5   eu_sales         16673 non-null  float64
     6   jp_sales         16675 non-null  float64
     7   other_sales      16679 non-null  float64
     8   critic_score     8085 non-null   float64
     9   user_score       7558 non-null   float64
     10  rating           9901 non-null   object 
    dtypes: float64(7), object(4)
    memory usage: 1.5+ MB
    None



```python
# заменяем пропущенные значения в eu_sales и jp_sales на среднее значение в зависимости от названия платформы и года выхода
sales_null = ['eu_sales', 'jp_sales']
for pr in sales_null:
    if pr in df.columns:
        df[pr] = df[pr].fillna(
            df.groupby(['platform', 'year_of_release'])[pr].transform('mean'))
print(df.info())
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 16679 entries, 0 to 16955
    Data columns (total 11 columns):
     #   Column           Non-Null Count  Dtype  
    ---  ------           --------------  -----  
     0   name             16679 non-null  object 
     1   platform         16679 non-null  object 
     2   year_of_release  16679 non-null  float64
     3   genre            16679 non-null  object 
     4   na_sales         16679 non-null  float64
     5   eu_sales         16679 non-null  float64
     6   jp_sales         16679 non-null  float64
     7   other_sales      16679 non-null  float64
     8   critic_score     8085 non-null   float64
     9   user_score       7558 non-null   float64
     10  rating           9901 non-null   object 
    dtypes: float64(7), object(4)
    memory usage: 1.5+ MB
    None


Заполняем пропуски в столбцах с оценкой:


```python
df['critic_score'] = df['critic_score'].fillna(-1)
df['user_score'] = df['user_score'].fillna(-1)
df['rating'] = df['rating'].fillna('-1') 
print(df.info())
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 16679 entries, 0 to 16955
    Data columns (total 11 columns):
     #   Column           Non-Null Count  Dtype  
    ---  ------           --------------  -----  
     0   name             16679 non-null  object 
     1   platform         16679 non-null  object 
     2   year_of_release  16679 non-null  float64
     3   genre            16679 non-null  object 
     4   na_sales         16679 non-null  float64
     5   eu_sales         16679 non-null  float64
     6   jp_sales         16679 non-null  float64
     7   other_sales      16679 non-null  float64
     8   critic_score     16679 non-null  float64
     9   user_score       16679 non-null  float64
     10  rating           16679 non-null  object 
    dtypes: float64(7), object(4)
    memory usage: 1.5+ MB
    None


### Явные и неявные дубликаты в данных


```python
genres_unique = df['genre'].unique()
print(genres_unique)
print(f'Количество уникальных названий: {len(genres_unique)}')
platform_unique = df['platform'].unique()
print(platform_unique)
rating_unique = df['rating'].unique()
print(rating_unique)
year_of_release_unique = df['year_of_release'].unique()
print(year_of_release_unique)
```

    ['Sports' 'Platform' 'Racing' 'Role-Playing' 'Puzzle' 'Misc' 'Shooter'
     'Simulation' 'Action' 'Fighting' 'Adventure' 'Strategy' 'MISC'
     'ROLE-PLAYING' 'RACING' 'ACTION' 'SHOOTER' 'FIGHTING' 'SPORTS' 'PLATFORM'
     'ADVENTURE' 'SIMULATION' 'PUZZLE' 'STRATEGY']
    Количество уникальных названий: 24
    ['Wii' 'NES' 'GB' 'DS' 'X360' 'PS3' 'PS2' 'SNES' 'GBA' 'PS4' '3DS' 'N64'
     'PS' 'XB' 'PC' '2600' 'PSP' 'XOne' 'WiiU' 'GC' 'GEN' 'DC' 'PSV' 'SAT'
     'SCD' 'WS' 'NG' 'TG16' '3DO' 'GG' 'PCFX']
    ['E' '-1' 'M' 'T' 'E10+' 'K-A' 'AO' 'EC' 'RP']
    [2006. 1985. 2008. 2009. 1996. 1989. 1984. 2005. 1999. 2007. 2010. 2013.
     2004. 1990. 1988. 2002. 2001. 2011. 1998. 2015. 2012. 2014. 1992. 1997.
     1993. 1994. 1982. 2016. 2003. 1986. 2000. 1995. 1991. 1981. 1987. 1980.
     1983.]


В столбце с жанрами мы видим наличие неявных дубликатов. Приведем все названия к нижнему регистру


```python
df['genre'] = df['genre'].str.lower()
genres_unique = df['genre'].unique()

print(f"Теперь количество уникальных названий: {len(genres_unique)}") 
print(df.info())

```

    Теперь количество уникальных названий: 12
    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 16679 entries, 0 to 16955
    Data columns (total 11 columns):
     #   Column           Non-Null Count  Dtype  
    ---  ------           --------------  -----  
     0   name             16679 non-null  object 
     1   platform         16679 non-null  object 
     2   year_of_release  16679 non-null  float64
     3   genre            16679 non-null  object 
     4   na_sales         16679 non-null  float64
     5   eu_sales         16679 non-null  float64
     6   jp_sales         16679 non-null  float64
     7   other_sales      16679 non-null  float64
     8   critic_score     16679 non-null  float64
     9   user_score       16679 non-null  float64
     10  rating           16679 non-null  object 
    dtypes: float64(7), object(4)
    memory usage: 1.5+ MB
    None



```python
print(f'Количество строк до удаления дубликатов: {len(df)}')
df_duplicat = df.drop_duplicates()
print(f'Количество строк после удаления дубликатов: {len(df_duplicat)}')

```

    Количество строк до удаления дубликатов: 16679
    Количество строк после удаления дубликатов: 16444


Мы обнаружили 235 явных дубликатов. В столбце с названиями жанров неявных дубликатов была половина (12 названий). 
В итоге мы дошли до 16444 полностью уникальных строк

 


```python
absolut = len(prom_itog) - len(df_duplicat)
print(f'Количество удалённых строк в абсолютном значении: {absolut}') 
```

    Количество удалённых строк в абсолютном значении: 512



```python
otnosit = absolut/len(prom_itog)
print(f'Количество удалённых строк в относительном значении: {round(otnosit, 2)}')
```

    Количество удалённых строк в относительном значении: 0.03


Промежуточный вывод: в ходе выполнения предобработки данных мы:
* привели название столбцов к верному и удобному стилю; 
* исправили тип данных со строчного на вещественных в столбцах eu_sales, jp_sales и user_score; 
* избавились от ошибок, дубликатов и пропусков, удалив 512 строк, что составляет 0.03. Из них 235 являлись явными дубликатами. 275 строк были без даты.

Столбцы с большим количеством пропусков (оценка критиков, пользователей и рейтинг) были заменены отрицательным значением.

Данные готовы для работы.

---

## Фильтрация данных

Коллеги хотят изучить историю продаж игр в начале XXI века, и их интересует период с 2000 по 2013 год включительно. 


```python
# меняем тип данных на целочисленный с понижением размерности данных
df['year_of_release'] = pd.to_numeric(df['year_of_release'], downcast='integer') 
print(df.info())
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 16679 entries, 0 to 16955
    Data columns (total 11 columns):
     #   Column           Non-Null Count  Dtype  
    ---  ------           --------------  -----  
     0   name             16679 non-null  object 
     1   platform         16679 non-null  object 
     2   year_of_release  16679 non-null  int16  
     3   genre            16679 non-null  object 
     4   na_sales         16679 non-null  float64
     5   eu_sales         16679 non-null  float64
     6   jp_sales         16679 non-null  float64
     7   other_sales      16679 non-null  float64
     8   critic_score     16679 non-null  float64
     9   user_score       16679 non-null  float64
     10  rating           16679 non-null  object 
    dtypes: float64(6), int16(1), object(4)
    memory usage: 1.4+ MB
    None



```python
df_actual = df_duplicat[(df_duplicat['year_of_release'] >= 2000) & (df_duplicat['year_of_release'] <= 2013)]
print(df_actual)
```

                                                       name platform  \
    0                                            Wii Sports      Wii   
    2                                        Mario Kart Wii      Wii   
    3                                     Wii Sports Resort      Wii   
    6                                 New Super Mario Bros.       DS   
    7                                              Wii Play      Wii   
    ...                                                 ...      ...   
    16947                     Men in Black II: Alien Escape       GC   
    16949                Woody Woodpecker in Crazy Castle 5      GBA   
    16950  SCORE International Baja 1000: The Official Game      PS2   
    16952                                  LMA Manager 2007     X360   
    16954                                  Spirits & Spells      GBA   
    
           year_of_release     genre  na_sales  eu_sales  jp_sales  other_sales  \
    0               2006.0    sports     41.36     28.96      3.77         8.45   
    2               2008.0    racing     15.68     12.76      3.79         3.29   
    3               2009.0    sports     15.61     10.93      3.28         2.95   
    6               2006.0  platform     11.28      9.14      6.50         2.88   
    7               2006.0      misc     13.96      9.18      2.93         2.84   
    ...                ...       ...       ...       ...       ...          ...   
    16947           2003.0   shooter      0.01      0.00      0.00         0.00   
    16949           2002.0  platform      0.01      0.00      0.00         0.00   
    16950           2008.0    racing      0.00      0.00      0.00         0.00   
    16952           2006.0    sports      0.00      0.01      0.00         0.00   
    16954           2003.0  platform      0.01      0.00      0.00         0.00   
    
           critic_score  user_score rating  
    0              76.0         8.0      E  
    2              82.0         8.3      E  
    3              80.0         8.0      E  
    6              89.0         8.5      E  
    7              58.0         6.6      E  
    ...             ...         ...    ...  
    16947          -1.0        -1.0      T  
    16949          -1.0        -1.0     -1  
    16950          -1.0        -1.0     -1  
    16952          -1.0        -1.0     -1  
    16954          -1.0        -1.0     -1  
    
    [12781 rows x 11 columns]


---

## Категоризация данных
    
Задания:

- Разделите все игры по оценкам пользователей и выделите такие категории: высокая оценка (от 8 до 10 включительно), средняя оценка (от 3 до 8, не включая правую границу интервала) и низкая оценка (от 0 до 3, не включая правую границу интервала).


```python
df_actual.loc[:, 'categore_user'] = pd.cut(df_actual['user_score'], bins = [0, 3, 8, 10], labels = ['низкая оценка', 'средняя оценка', 'высокая оценка'], right=False, include_lowest=True)
print(df_actual['categore_user'])
```

    0        высокая оценка
    2        высокая оценка
    3        высокая оценка
    6        высокая оценка
    7        средняя оценка
                  ...      
    16947               NaN
    16949               NaN
    16950               NaN
    16952               NaN
    16954               NaN
    Name: categore_user, Length: 12781, dtype: category
    Categories (3, object): ['низкая оценка' < 'средняя оценка' < 'высокая оценка']


- Разделите все игры по оценкам критиков и выделите такие категории: высокая оценка (от 80 до 100 включительно), средняя оценка (от 30 до 80, не включая правую границу интервала) и низкая оценка (от 0 до 30, не включая правую границу интервала).


```python
df_actual.loc[:, 'categore_critic'] = pd.cut(df_actual['critic_score'], bins = [0, 30, 80, 100], labels = ['низкая оценка', 'средняя оценка', 'высокая оценка'], right=False, include_lowest=True)
print(df_actual['categore_critic'])
```

    0        средняя оценка
    2        высокая оценка
    3        высокая оценка
    6        высокая оценка
    7        средняя оценка
                  ...      
    16947               NaN
    16949               NaN
    16950               NaN
    16952               NaN
    16954               NaN
    Name: categore_critic, Length: 12781, dtype: category
    Categories (3, object): ['низкая оценка' < 'средняя оценка' < 'высокая оценка']



```python
group_user = df_actual.groupby('categore_user')['name'].count()
print(f'Категоризация игр по оценке пользователей: {group_user}')
```

    Категоризация игр по оценке пользователей: categore_user
    низкая оценка      116
    средняя оценка    4081
    высокая оценка    2286
    Name: name, dtype: int64



```python
group_critic = df_actual.groupby('categore_critic')['name'].count()
print(f'Категоризация игр по оценке критиков: {group_critic}')
```

    Категоризация игр по оценке критиков: categore_critic
    низкая оценка       55
    средняя оценка    5422
    высокая оценка    1692
    Name: name, dtype: int64


 

- Выделите топ-7 платформ по количеству игр, выпущенных за весь актуальный период.


```python
top_platform = df_actual['platform'].value_counts()
print(top_platform.head(7))
```

    PS2     2127
    DS      2120
    Wii     1275
    PSP     1180
    X360    1121
    PS3     1087
    GBA      811
    Name: platform, dtype: int64


---

## Итоговый вывод

**Вывод:** PS2 (2127 игр) и DS (2120 игр) выходят с большим отрывом по количеству игр, выпущенных за весь актуальный период. Это говорит о популярности платформ.
    Мы видем, что потом популярность PlayStation пошла на спад. Возможно, разработчикам стало сложней конкурировать с выходом других интересных и качественных платформ.
    
   Коллеги из игры "Секреты Темнолесья" имеют все шансы выйти на мировой уровень и конкурировать с крупными платформами.

**Для достижения поставленной цели мы выполнили следующее:**
   * Проверили корректность данных, исправили неверный тип данных в столбцах eu_sales, jp_sales и user_score;
   * Избавились от 512 пропусков;
   * Заменили поти половину пропущенных значений на нейтральное число в столбцах с оценкой критиков, пользователей и рейтинга организации ESRB;
   * Отобрали данные с 2000 по 2013 год включительно;
   * Категоризовали игры по оценкам пользователей и экспертов. Присвоенные категории:;
   * Выделили топ-7 платформ по количеству игр: ***PS2, DS, Wii, PSP, X360, PS3, GBA.***

**В ходе выполнения работы были добавлены следующие столбцы:**

**categore_user** - категоризация оценок пользователей

**categore_critic** - категоризация оценок критиков
